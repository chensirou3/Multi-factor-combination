# OOS 样本外测试结果分析报告

**测试完成时间**: 2025-11-19 16:04:22  
**测试模式**: Score Mode  
**测试品种**: 4 个 (ETHUSD, XAUUSD, XAGUSD, EURUSD)  
**总配置数**: 1,224 个参数组合/品种  

---

## 📊 总体结果汇总

### 关键指标

| 指标 | 数值 | 评估 |
|------|------|------|
| 平均训练集最大 Sharpe | **1.217** | ✅ 良好 |
| 平均测试集平均 Sharpe | **-0.273** | ❌ 负收益 |
| 测试集正 Sharpe 比例 | **25%** | ⚠️ 较低 |
| 测试集正收益品种数 | **1/4** | ❌ 仅 25% |

### 初步结论

⚠️ **严重过拟合警告**
- 训练集表现优秀（Sharpe 1.2+）
- 测试集表现不佳（平均 Sharpe -0.27）
- 只有 1 个品种（ETHUSD）在测试集上保持正收益
- **Sharpe 衰减率**: 约 -122% （从 1.217 到 -0.273）

---

## 📈 各品种详细分析

### 1️⃣ ETHUSD - ✅ 唯一通过测试

| 阶段 | 最大 Sharpe | 平均 Sharpe | 配置数 | 正 Sharpe 比例 |
|------|-------------|-------------|--------|----------------|
| **训练集** | 2.644 | -0.102 | 1,224 | - |
| **测试集** | 0.064 | 0.064 | 1 | 100% |

**表现**:
- ✅ 测试集保持正收益（Sharpe 0.064）
- ⚠️ Sharpe 大幅下降（-97.6%）
- ⚠️ 只有 1 个配置通过选择（可能选择标准过严）
- ✅ 平均 23 笔交易（样本量尚可）

**核心组合 (0.6, -0.3)**:
- 训练集 Sharpe: 0.968
- 测试集 Sharpe: 0.370
- ✅ 测试集表现优于平均水平

---

### 2️⃣ XAUUSD - ❌ 测试集负收益

| 阶段 | 最大 Sharpe | 平均 Sharpe | 配置数 | 正 Sharpe 比例 |
|------|-------------|-------------|--------|----------------|
| **训练集** | 0.388 | -0.157 | 1,224 | - |
| **测试集** | -0.275 | -0.454 | 9 | 0% |

**表现**:
- ❌ 测试集全部负收益
- ❌ 训练集表现本身就较弱（最大 Sharpe 0.388）
- ⚠️ 9 个配置通过选择，但全部失败
- ✅ 平均 28.8 笔交易（样本量充足）

**问题**:
- 策略在黄金上可能不适用
- 或者需要不同的参数范围

---

### 3️⃣ XAGUSD - ❌ 测试集零收益

| 阶段 | 最大 Sharpe | 平均 Sharpe | 配置数 | 正 Sharpe 比例 |
|------|-------------|-------------|--------|----------------|
| **训练集** | 0.581 | -0.097 | 1,216 | - |
| **测试集** | 0.000 | 0.000 | 1 | 0% |

**表现**:
- ❌ 测试集零收益（可能只有 1 笔交易）
- ⚠️ 只有 1 个配置通过选择
- ❌ 平均 1 笔交易（样本量严重不足）

**问题**:
- 信号生成过少
- 参数选择可能过于严格

---

### 4️⃣ EURUSD - ❌ 测试集负收益

| 阶段 | 最大 Sharpe | 平均 Sharpe | 配置数 | 正 Sharpe 比例 |
|------|-------------|-------------|--------|----------------|
| **训练集** | 1.254 | -0.203 | 1,224 | - |
| **测试集** | -0.641 | -0.703 | 4 | 0% |

**表现**:
- ❌ 测试集严重负收益（Sharpe -0.70）
- ⚠️ 训练集最大 Sharpe 尚可（1.254）
- ❌ 4 个配置全部失败
- ❌ 平均 2.25 笔交易（样本量不足）

**问题**:
- 严重过拟合
- 信号生成过少

---

## 🔍 核心问题诊断

### 1. **过拟合严重**

**证据**:
- 训练集平均最大 Sharpe: 1.217
- 测试集平均 Sharpe: -0.273
- **衰减率**: -122%

**原因**:
- 参数空间过大（1,224 个配置）
- 训练集可能存在数据窥探
- 策略逻辑可能过于复杂

### 2. **信号生成不足**

**证据**:
- XAGUSD: 平均 1 笔交易
- EURUSD: 平均 2.25 笔交易
- 只有 ETHUSD 和 XAUUSD 有足够交易量

**原因**:
- z-score 阈值过高（2.0+）
- 因子组合可能不适合某些品种
- 持仓时间设置可能不合理

### 3. **参数选择过严**

**证据**:
- ETHUSD: 只有 1/1224 配置通过
- XAGUSD: 只有 1/1216 配置通过
- 平均通过率: 约 0.3%

**原因**:
- 高原区阈值（70% × max Sharpe）可能过高
- Top K 设置（K=20）可能过小
- 需要调整选择策略

---

## 💡 改进建议

### 🔴 紧急优先级

1. **简化策略**
   - 减少参数维度
   - 考虑只使用核心组合 (0.6, -0.3)
   - 移除表现差的品种（XAUUSD, XAGUSD, EURUSD）

2. **降低信号阈值**
   - 将 z-score 阈值从 2.0 降低到 1.5
   - 增加信号生成频率
   - 提高样本量

3. **调整参数选择**
   - 降低高原区阈值（从 70% 到 50%）
   - 增加 Top K（从 20 到 50）
   - 使用更宽松的选择标准

### 🟡 中等优先级

4. **分品种优化**
   - ETHUSD: 继续优化（唯一有效品种）
   - XAUUSD/XAGUSD/EURUSD: 重新设计或放弃

5. **时间周期测试**
   - 测试 1H/8H/1D 周期
   - 可能某些品种在其他周期表现更好

6. **因子改进**
   - 重新审视 ManipScore 和 OFI 的计算
   - 考虑添加其他因子
   - 测试不同的因子组合方式

### 🟢 低优先级

7. **风险管理**
   - 添加止损/止盈
   - 动态仓位管理
   - 最大回撤控制

8. **集成学习**
   - 使用多个参数组合的集成
   - 动态权重调整
   - 自适应参数选择

---

## 🎯 下一步行动计划

### 立即执行（本周）

1. **专注 ETHUSD**
   - ✅ 唯一有效品种
   - 深入分析核心组合 (0.6, -0.3) 的表现
   - 测试不同的 z-score 阈值

2. **降低信号阈值**
   - 修改 `composite_z_entry` 从 2.0 到 1.5
   - 重新运行 ETHUSD 的 OOS 测试
   - 观察交易量和 Sharpe 变化

3. **调整参数选择**
   - 修改高原区阈值从 70% 到 50%
   - 增加 Top K 从 20 到 50
   - 重新运行参数选择

### 短期目标（本月）

4. **多周期测试**
   - 测试 ETHUSD 在 1H/8H/1D 周期
   - 找到最佳时间周期

5. **策略简化**
   - 固定核心组合 (0.6, -0.3)
   - 只优化 z-score 阈值和持仓时间
   - 减少过拟合风险

### 中期目标（下月）

6. **实盘模拟**
   - 如果 ETHUSD 表现稳定
   - 进行纸面交易测试
   - 验证实盘可行性

---

## 📁 相关文件

- **汇总结果**: `results/oos/score_oos_summary_per_symbol.csv`
- **总体统计**: `results/oos/score_oos_summary_overall.csv`
- **各品种训练集**: `results/oos/score_oos_train_{SYMBOL}_4H.csv`
- **各品种测试集**: `results/oos/score_oos_test_{SYMBOL}_4H.csv`
- **核心组合跟踪**: `results/oos/score_oos_core_combo_{SYMBOL}_4H.csv`

---

**结论**: 当前策略存在严重过拟合问题，建议专注于 ETHUSD 品种，简化策略，降低信号阈值，并调整参数选择标准。

